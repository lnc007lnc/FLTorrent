global:
  output_base_dir: ./experiments_output_gossip_ring_celeba_gpu2
  code_snapshot_dir: ./experiments_snapshots
  partition: gpu2
  nodes: 1
  cpus_per_task: 64
  mem: 480G
  gpus_per_node: 4
  time_limit: "72:00:00"

  # Common settings for CelebA
  CLIENT_NUM: 50
  CHUNK_NUM: 16
  CHUNK_TMP_DIR: /tmp/fl_chunks_celeba
  DATA_ROOT: ./data/
  DATA_SHARE_TEST_DATASET: true
  DATA_SPLITS: [0.8, 0.1, 0.1]
  DATA_SPLITTER: lda
  DATA_SUBSAMPLE: 1.0

experiments:
  - name: gossip_ring_celeba_resnet_alpha100000
    description: "GOSSIP Ring CelebA+ResNet18: 300 rounds, IID (alpha=100000)"
    config:
      MODEL_TYPE: resnet18
      MODEL_OUT_CHANNELS: 1
      TRAINER_TYPE: cvtrainer
      CRITERION_TYPE: BCEWithLogitsLoss
      DATASET: celeba
      BATCH_SIZE: 16
      LEARNING_RATE: 0.0001
      OPTIMIZER: Adam
      WEIGHT_DECAY: 0.0005
      GRAD_CLIP: 5.0
      LOCAL_UPDATE_STEPS: 1
      TOTAL_ROUNDS: 300

      LR_SCHEDULER_TYPE: SequentialLR
      LR_SCHEDULER_MILESTONES: [11]
      LR_SCHEDULER_PHASE1_START_FACTOR: 0.01
      LR_SCHEDULER_PHASE1_TOTAL_ITERS: 10
      LR_SCHEDULER_PHASE2_ETA_MIN: 1e-8
      LR_SCHEDULER_PHASE2_T_MAX: 290

      DATA_SPLIT_ALPHA: 100000

      EVAL_METRICS: [acc, correct, f1]

      GOSSIP_ENABLE: true
      GOSSIP_ITERATIONS: 1
      GOSSIP_MIXING_WEIGHT: 0.5
      GOSSIP_MODE: neighbor_avg

      TOPOLOGY_TYPE: ring

      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 1000000.0
      BT_NEIGHBOR_ONLY: true

  - name: gossip_ring_celeba_resnet_alpha1
    description: "GOSSIP Ring CelebA+ResNet18: 300 rounds, moderate non-IID (alpha=1.0)"
    config:
      MODEL_TYPE: resnet18
      MODEL_OUT_CHANNELS: 1
      TRAINER_TYPE: cvtrainer
      CRITERION_TYPE: BCEWithLogitsLoss
      DATASET: celeba
      BATCH_SIZE: 16
      LEARNING_RATE: 0.0001
      OPTIMIZER: Adam
      WEIGHT_DECAY: 0.0005
      GRAD_CLIP: 5.0
      LOCAL_UPDATE_STEPS: 1
      TOTAL_ROUNDS: 300

      LR_SCHEDULER_TYPE: SequentialLR
      LR_SCHEDULER_MILESTONES: [11]
      LR_SCHEDULER_PHASE1_START_FACTOR: 0.01
      LR_SCHEDULER_PHASE1_TOTAL_ITERS: 10
      LR_SCHEDULER_PHASE2_ETA_MIN: 1e-8
      LR_SCHEDULER_PHASE2_T_MAX: 290

      DATA_SPLIT_ALPHA: 1.0

      EVAL_METRICS: [acc, correct, f1]

      GOSSIP_ENABLE: true
      GOSSIP_ITERATIONS: 1
      GOSSIP_MIXING_WEIGHT: 0.5
      GOSSIP_MODE: neighbor_avg

      TOPOLOGY_TYPE: ring

      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 1000000.0
      BT_NEIGHBOR_ONLY: true

  - name: gossip_ring_celeba_resnet_alpha03
    description: "GOSSIP Ring CelebA+ResNet18: 300 rounds, high non-IID (alpha=0.3)"
    config:
      MODEL_TYPE: resnet18
      MODEL_OUT_CHANNELS: 1
      TRAINER_TYPE: cvtrainer
      CRITERION_TYPE: BCEWithLogitsLoss
      DATASET: celeba
      BATCH_SIZE: 16
      LEARNING_RATE: 0.0001
      OPTIMIZER: Adam
      WEIGHT_DECAY: 0.0005
      GRAD_CLIP: 5.0
      LOCAL_UPDATE_STEPS: 1
      TOTAL_ROUNDS: 300

      LR_SCHEDULER_TYPE: SequentialLR
      LR_SCHEDULER_MILESTONES: [11]
      LR_SCHEDULER_PHASE1_START_FACTOR: 0.01
      LR_SCHEDULER_PHASE1_TOTAL_ITERS: 10
      LR_SCHEDULER_PHASE2_ETA_MIN: 1e-8
      LR_SCHEDULER_PHASE2_T_MAX: 290

      DATA_SPLIT_ALPHA: 0.3

      EVAL_METRICS: [acc, correct, f1]

      GOSSIP_ENABLE: true
      GOSSIP_ITERATIONS: 1
      GOSSIP_MIXING_WEIGHT: 0.5
      GOSSIP_MODE: neighbor_avg

      TOPOLOGY_TYPE: ring

      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 1000000.0
      BT_NEIGHBOR_ONLY: true
