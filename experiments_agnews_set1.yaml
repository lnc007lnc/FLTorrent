# ============================================================================
# AG News Set1: CFL vs FLTorrent Comparison (12 experiments)
# ============================================================================
#
# Usage:
#   python run_ray_hpc.py --batch experiments_agnews_set1.yaml
#
# Experiments (12 total):
#   - CFL (Centralized FL): 60 rounds, alpha=100000/1.0/0.3
#   - FLTorrent t=0 (no wait): 60 rounds, alpha=100000/1.0/0.3
#   - FLTorrent t=inf (full wait): 60 rounds, alpha=100000/1.0/0.3
#   - FLTorrent t=60s (partial): 60 rounds, alpha=100000/1.0/0.3
#
# Scientific Parameters for AG News + TinyBERT:
#   - Learning Rate: 2e-5 (BERT fine-tuning standard)
#   - Batch Size: 32
#   - Local Update Steps: 1
#   - Optimizer: AdamW
#   - Weight Decay: 0.01
#   - Grad Clip: 1.0
#   - Max Seq Length: 128
#
# ============================================================================

global:
  code_snapshot_dir: "./experiments_snapshots"
  output_base_dir: "./experiments_output_agnews_set1"

  # GPU3 Node
  partition: "gpu3"
  nodes: 1
  gpus_per_node: 2
  cpus_per_task: 128
  mem: "1400G"
  time_limit: "24:00:00"

experiments:
  # ==========================================================================
  # CFL (Centralized Federated Learning) - 60 rounds
  # ==========================================================================

  - name: "cfl_agnews_alpha100000"
    description: "CFL AG News: 60 rounds, IID (alpha=100000)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      # CFL: No BitTorrent, standard FedAvg
      BITTORRENT_ENABLE: false
      GOSSIP_ENABLE: false
      # AG News Dataset
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 100000.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      # Model
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      # Training Parameters (Scientific)
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]

  - name: "cfl_agnews_alpha1"
    description: "CFL AG News: 60 rounds, moderate non-IID (alpha=1.0)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: false
      GOSSIP_ENABLE: false
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 1.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]

  - name: "cfl_agnews_alpha03"
    description: "CFL AG News: 60 rounds, high non-IID (alpha=0.3)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: false
      GOSSIP_ENABLE: false
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 0.3
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]

  # ==========================================================================
  # FLTorrent t=0 (No Wait - Immediate Timeout) - 60 rounds
  # ==========================================================================

  - name: "fltorrent_t0_agnews_alpha100000"
    description: "FLTorrent t=0 AG News: 60 rounds, IID (alpha=100000)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      # FLTorrent with zero timeout (no waiting)
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 0.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      # AG News Dataset
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 100000.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  - name: "fltorrent_t0_agnews_alpha1"
    description: "FLTorrent t=0 AG News: 60 rounds, moderate non-IID (alpha=1.0)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 0.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 1.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  - name: "fltorrent_t0_agnews_alpha03"
    description: "FLTorrent t=0 AG News: 60 rounds, high non-IID (alpha=0.3)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 0.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 0.3
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  # ==========================================================================
  # FLTorrent t=inf (Infinite Wait - Full Aggregation) - 60 rounds
  # ==========================================================================

  - name: "fltorrent_inf_agnews_alpha100000"
    description: "FLTorrent t=inf AG News: 60 rounds, IID (alpha=100000)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      # FLTorrent with infinite timeout (wait for all chunks)
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 100000.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      # AG News Dataset
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 100000.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  - name: "fltorrent_inf_agnews_alpha1"
    description: "FLTorrent t=inf AG News: 60 rounds, moderate non-IID (alpha=1.0)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 100000.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 1.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  - name: "fltorrent_inf_agnews_alpha03"
    description: "FLTorrent t=inf AG News: 60 rounds, high non-IID (alpha=0.3)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 100000.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 0.3
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  # ==========================================================================
  # FLTorrent t=60s (Partial Reception) - 60 rounds
  # ==========================================================================

  - name: "fltorrent_t60_agnews_alpha100000"
    description: "FLTorrent t=60s AG News: 60 rounds, IID (alpha=100000)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      # FLTorrent with 60s timeout (partial reception)
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 60.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      # AG News Dataset
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 100000.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  - name: "fltorrent_t60_agnews_alpha1"
    description: "FLTorrent t=60s AG News: 60 rounds, moderate non-IID (alpha=1.0)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 60.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 1.0
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  - name: "fltorrent_t60_agnews_alpha03"
    description: "FLTorrent t=60s AG News: 60 rounds, high non-IID (alpha=0.3)"
    config:
      CLIENT_NUM: 50
      TOTAL_ROUNDS: 60
      BITTORRENT_ENABLE: true
      BITTORRENT_TIMEOUT: 60.0
      BT_ENABLE_COMPENSATION: true
      BT_RARITY_WEIGHT: 0.01
      GOSSIP_ENABLE: false
      CHUNK_NUM: 16
      TOPOLOGY_TYPE: "mesh"
      TOPOLOGY_CONNECTIONS: 4
      DATASET: "ag_news@huggingface_datasets"
      DATA_ROOT: ""
      DATA_TEXT_FIELD: "text"
      DATA_SPLIT_TRAIN_FOR_VAL: 0.1
      DATA_MAX_LEN: 128
      DATA_HF_HALF_VAL_DUMMY_TEST: false
      DATA_SHARE_TEST_DATASET: true
      DATA_SPLITTER: "lda"
      DATA_SPLIT_ALPHA: 0.3
      DATA_SPLITS: [0.8, 0.1, 0.1]
      BATCH_SIZE: 32
      MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
      MODEL_TASK: "SequenceClassification"
      MODEL_OUT_CHANNELS: 4
      TRAINER_TYPE: "nlptrainer"
      LOCAL_UPDATE_STEPS: 1
      LEARNING_RATE: 0.00002
      OPTIMIZER: "AdamW"
      WEIGHT_DECAY: 0.01
      GRAD_CLIP: 1.0
      CRITERION_TYPE: "CrossEntropyLoss"
      EVAL_FREQ: 1
      EVAL_METRICS: ["acc", "f1"]
      CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
      CHUNK_NFS_COMPATIBLE: false

  # ==========================================================================
  # GOSSIP (Decentralized Gossip Protocol) - COMMENTED OUT
  # ==========================================================================

  # - name: "gossip_agnews_alpha100000"
  #   description: "GOSSIP AG News: 90 rounds, IID (alpha=100000)"
  #   config:
  #     CLIENT_NUM: 50
  #     TOTAL_ROUNDS: 90
  #     # GOSSIP settings
  #     BITTORRENT_ENABLE: true
  #     BITTORRENT_TIMEOUT: 1000000.0
  #     GOSSIP_ENABLE: true
  #     GOSSIP_MODE: "neighbor_avg"
  #     GOSSIP_ITERATIONS: 2
  #     GOSSIP_MIXING_WEIGHT: 0.5
  #     CHUNK_NUM: 16
  #     TOPOLOGY_TYPE: "mesh"
  #     TOPOLOGY_CONNECTIONS: 4
  #     # AG News Dataset
  #     DATASET: "ag_news@huggingface_datasets"
  #     DATA_ROOT: ""
  #     DATA_TEXT_FIELD: "text"
  #     DATA_SPLIT_TRAIN_FOR_VAL: 0.1
  #     DATA_MAX_LEN: 128
  #     DATA_HF_HALF_VAL_DUMMY_TEST: false
  #     DATA_SHARE_TEST_DATASET: true
  #     DATA_SPLITTER: "lda"
  #     DATA_SPLIT_ALPHA: 100000.0
  #     DATA_SPLITS: [0.8, 0.1, 0.1]
  #     BATCH_SIZE: 32
  #     MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
  #     MODEL_TASK: "SequenceClassification"
  #     MODEL_OUT_CHANNELS: 4
  #     TRAINER_TYPE: "nlptrainer"
  #     LOCAL_UPDATE_STEPS: 1
  #     LEARNING_RATE: 0.00002
  #     OPTIMIZER: "AdamW"
  #     WEIGHT_DECAY: 0.01
  #     GRAD_CLIP: 1.0
  #     CRITERION_TYPE: "CrossEntropyLoss"
  #     EVAL_FREQ: 1
  #     EVAL_METRICS: ["acc", "f1"]
  #     CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
  #     CHUNK_NFS_COMPATIBLE: false

  # - name: "gossip_agnews_alpha1"
  #   description: "GOSSIP AG News: 90 rounds, moderate non-IID (alpha=1.0)"
  #   config:
  #     CLIENT_NUM: 50
  #     TOTAL_ROUNDS: 90
  #     BITTORRENT_ENABLE: true
  #     BITTORRENT_TIMEOUT: 1000000.0
  #     GOSSIP_ENABLE: true
  #     GOSSIP_MODE: "neighbor_avg"
  #     GOSSIP_ITERATIONS: 2
  #     GOSSIP_MIXING_WEIGHT: 0.5
  #     CHUNK_NUM: 16
  #     TOPOLOGY_TYPE: "mesh"
  #     TOPOLOGY_CONNECTIONS: 4
  #     DATASET: "ag_news@huggingface_datasets"
  #     DATA_ROOT: ""
  #     DATA_TEXT_FIELD: "text"
  #     DATA_SPLIT_TRAIN_FOR_VAL: 0.1
  #     DATA_MAX_LEN: 128
  #     DATA_HF_HALF_VAL_DUMMY_TEST: false
  #     DATA_SHARE_TEST_DATASET: true
  #     DATA_SPLITTER: "lda"
  #     DATA_SPLIT_ALPHA: 1.0
  #     DATA_SPLITS: [0.8, 0.1, 0.1]
  #     BATCH_SIZE: 32
  #     MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
  #     MODEL_TASK: "SequenceClassification"
  #     MODEL_OUT_CHANNELS: 4
  #     TRAINER_TYPE: "nlptrainer"
  #     LOCAL_UPDATE_STEPS: 1
  #     LEARNING_RATE: 0.00002
  #     OPTIMIZER: "AdamW"
  #     WEIGHT_DECAY: 0.01
  #     GRAD_CLIP: 1.0
  #     CRITERION_TYPE: "CrossEntropyLoss"
  #     EVAL_FREQ: 1
  #     EVAL_METRICS: ["acc", "f1"]
  #     CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
  #     CHUNK_NFS_COMPATIBLE: false

  # - name: "gossip_agnews_alpha03"
  #   description: "GOSSIP AG News: 90 rounds, high non-IID (alpha=0.3)"
  #   config:
  #     CLIENT_NUM: 50
  #     TOTAL_ROUNDS: 90
  #     BITTORRENT_ENABLE: true
  #     BITTORRENT_TIMEOUT: 1000000.0
  #     GOSSIP_ENABLE: true
  #     GOSSIP_MODE: "neighbor_avg"
  #     GOSSIP_ITERATIONS: 2
  #     GOSSIP_MIXING_WEIGHT: 0.5
  #     CHUNK_NUM: 16
  #     TOPOLOGY_TYPE: "mesh"
  #     TOPOLOGY_CONNECTIONS: 4
  #     DATASET: "ag_news@huggingface_datasets"
  #     DATA_ROOT: ""
  #     DATA_TEXT_FIELD: "text"
  #     DATA_SPLIT_TRAIN_FOR_VAL: 0.1
  #     DATA_MAX_LEN: 128
  #     DATA_HF_HALF_VAL_DUMMY_TEST: false
  #     DATA_SHARE_TEST_DATASET: true
  #     DATA_SPLITTER: "lda"
  #     DATA_SPLIT_ALPHA: 0.3
  #     DATA_SPLITS: [0.8, 0.1, 0.1]
  #     BATCH_SIZE: 32
  #     MODEL_TYPE: "./pretrained_models/TinyBERT_General_4L_312D@transformers"
  #     MODEL_TASK: "SequenceClassification"
  #     MODEL_OUT_CHANNELS: 4
  #     TRAINER_TYPE: "nlptrainer"
  #     LOCAL_UPDATE_STEPS: 1
  #     LEARNING_RATE: 0.00002
  #     OPTIMIZER: "AdamW"
  #     WEIGHT_DECAY: 0.01
  #     GRAD_CLIP: 1.0
  #     CRITERION_TYPE: "CrossEntropyLoss"
  #     EVAL_FREQ: 1
  #     EVAL_METRICS: ["acc", "f1"]
  #     CHUNK_TMP_DIR: "/tmp/fl_chunks_agnews"
  #     CHUNK_NFS_COMPATIBLE: false
